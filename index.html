<!DOCTYPE html>
<html>
  <head>
    <title>Decompilation Status</title>
    <style>
      body {
        background: #202020;
        color: #f0f0f0;
        font-family: sans-serif;
      }

      h1 {
        text-align: center;
      }

      .main {
        width: 800px;
        max-width: 100%;
        margin: auto;
      }

      #search {
        width: 100%;
        box-sizing: border-box;
        background: #303030;
        color: #f0f0f0;
        border: 1px #f0f0f0 solid;
        padding: 0.5em;
        border-radius: 0.5em;
      }

      #search::placeholder {
        color: #b0b0b0;
      }

      #listing {
        width: 100%;
        border-collapse: collapse;
        font-family: monospace;
      }

      tr[data-address]:hover {
        background: #404040 !important;
      }

      tr[data-address]:nth-child(odd of :not([hidden])), #listing > thead th {
        background: #282828;
      }

      tr[data-address]:nth-child(even of :not([hidden])) {
        background: #383838;
      }

      table#listing {
        border: 1px #f0f0f0 solid;
        table-layout: fixed;
      }

      #listing > thead th {
        padding: 0.5em;
        user-select: none;
        text-align: left;
      }

      #listing > thead th[data-col="address"],
      #listing > thead th[data-col="recomp"] {
        /* enough for "0x" and 8 digit address */
        width: 10ch;
      }

      #listing > thead th[data-col="diffs"],
      #listing > thead th[data-col="matching"] {
        width: 8ch;
      }

      #listing > thead th > div {
        display: flex;
        column-gap: 0.5em;
      }

      #listing > thead th > div > span {
        cursor: pointer;
      }

      #listing > thead th > div > span:hover {
        text-decoration: underline;
        text-decoration-style: dotted;
      }

      #listing > thead th:last-child > div {
        /* Draw the sort triangle to the left of the last column. */
        flex-direction: row-reverse;
        justify-content: right;
      }

      .diffneg {
        color: #FF8080;
      }

      .diffpos {
        color: #80FF80;
      }

      .diffslug {
        color: #8080FF;
      }

      .identical {
        font-style: italic;
        text-align: center;
      }

      sort-indicator {
        user-select: none;
      }

      .filters {
        align-items: top;
        display: flex;
        font-size: 10pt;
        justify-content: space-between;
        margin: 0.5em 0 1em 0;
      }

      .filters > fieldset {
        /* checkbox and radio buttons v-aligned with text */
        align-items: center;
        display: flex;
      }

      .filters > fieldset > input, .filters > fieldset > label {
        cursor: pointer;
      }

      .filters > fieldset > label {
        margin-right: 10px;
      }

      table.diffTable {
        border-collapse: collapse;
      }

      table.diffTable:not(:last-child) {
        /* visual gap *between* diff context groups */
        margin-bottom: 40px;
      }

      table.diffTable td, table.diffTable th {
        border: 0 none;
        padding: 0 10px 0 0;
      }

      table.diffTable th {
        /* don't break address if asm line is long */
        word-break: keep-all;
      }

      diff-display[data-option="0"] th:nth-child(1) {
        display: none;
      }

      diff-display[data-option="0"] th:nth-child(2),
      diff-display[data-option="1"] th:nth-child(2) {
        display: none;
      }

      label {
        user-select: none;
      }

      #pageDisplay > button {
        cursor: pointer;
        padding: 0.25em 0.5em;
      }

      #pageDisplay select {
        cursor: pointer;
        padding: 0.25em;
        margin: 0 0.5em;
      }

      p.rowcount {
        align-self: flex-end;
        font-size: 1.2em;
        margin-bottom: 0;
      }

      tr[data-diff]:not([hidden]) {
        contain: paint;
      }

      tr[data-diff] > td {
        border: 1px #f0f0f0 solid;
        border-bottom: 0px none;
        display: table-cell;
        padding: 0.5em;
        word-break: break-all !important;
      }

      tr[data-diff] > td > div.no-diff {
        font-style: italic;
        text-align: center;
      }

      tr[data-address] > td[data-col="name"]:hover {
        cursor: pointer;
        text-decoration: underline;
        text-decoration-style: dotted;
      }

      tr[data-address] > td:not(data-col="name"]) {
        white-space: nowrap;
      }

      tr[data-address] > td {
        border-top: 1px #f0f0f0 solid;
        display: table-cell;
        padding: 0.5em;
        vertical-align: top;
        white-space: nowrap;
      }

      tr[data-address] > td[data-col="name"] {
        white-space: wrap;
        word-break: break-all !important;
      }

      tr[data-address] > td:last-child {
        text-align: right;
      }

      can-copy {
        position: relative;
        cursor: pointer;
      }
      can-copy::after {
        background-color: #fff;
        color: #222;
        display: none;
        font-size: 12px;
        padding: 1px 2px;
        width: fit-content;
        border-radius: 1px;
        text-align: center;
        bottom: 120%;
        left: 0;
        box-shadow: 0 4px 14px 0 rgba(0,0,0,.2), 0 0 0 1px rgba(0,0,0,.05);
        position: absolute;
        white-space: nowrap;
        transition: .1s;
        content: 'Copy to clipboard';
      }
      can-copy:hover {
        text-decoration: underline;
        text-decoration-style: dotted;
      }
      can-copy:hover::after {
        display: block;
      }
      can-copy[copied]:hover::after {
        content: 'Copied!';
      }
    </style>
    <script>
      var report = {"file":"cmr2.exe","format":1,"timestamp":1756498439.0,"data":[{"address":"0x405626","name":"_WinMainCRTStartup","matching":0.8157894736842105,"recomp":"0x4020b6","diff":[["@@ -0x405626,64 +0x4020b6,64 @@",[{"both":[["0x405626","push ebp","0x4020b6"],["0x405627","mov ebp, esp","0x4020b7"],["0x405629","push -1","0x4020b9"]]},{"orig":[["0x40562b","push 0x5112d0"],["0x405630","push 0x4057b0"]],"recomp":[["0x4020bb","push <OFFSET1>"],["0x4020c0","push MSVCRT.dll::_except_handler3 (FUNCTION)"]]},{"both":[["0x405635","mov eax, dword ptr fs:[0]","0x4020c5"],["0x40563b","push eax","0x4020cb"],["0x40563c","mov dword ptr fs:[0], esp","0x4020cc"],["0x405643","sub esp, 0x68","0x4020d3"],["0x405646","push ebx","0x4020d6"],["0x405647","push esi","0x4020d7"],["0x405648","push edi","0x4020d8"],["0x405649","mov dword ptr [ebp - 0x18], esp","0x4020d9"],["0x40564c","xor ebx, ebx","0x4020dc"],["0x40564e","mov dword ptr [ebp - 4], ebx","0x4020de"],["0x405651","push 2","0x4020e1"],["0x405653","call dword ptr [->MSVCRT.dll::__set_app_type (IMPORT)]","0x4020e3"],["0x405659","pop ecx","0x4020e9"]]},{"orig":[["0x40565a","or dword ptr [<OFFSET2>], 0xffffffff"],["0x405661","or dword ptr [<OFFSET3>], 0xffffffff"]],"recomp":[["0x4020ea","or dword ptr [___onexitend (UNK)], 0xffffffff"],["0x4020f1","or dword ptr [___onexitbegin (UNK)], 0xffffffff"]]},{"both":[["0x405668","call dword ptr [->MSVCRT.dll::__p__fmode (IMPORT)]","0x4020f8"]]},{"orig":[["0x40566e","mov ecx, dword ptr [<OFFSET5>]"]],"recomp":[["0x4020fe","mov ecx, dword ptr [__fmode (UNK)]"]]},{"both":[["0x405674","mov dword ptr [eax], ecx","0x402104"],["0x405676","call dword ptr [->MSVCRT.dll::__p__commode (IMPORT)]","0x402106"]]},{"orig":[["0x40567c","mov ecx, dword ptr [<OFFSET7>]"]],"recomp":[["0x40210c","mov ecx, dword ptr [__commode (UNK)]"]]},{"both":[["0x405682","mov dword ptr [eax], ecx","0x402112"],["0x405684","mov eax, dword ptr [MSVCRT.dll::_adjust_fdiv (IMPORT)]","0x402114"],["0x405689","mov eax, dword ptr [eax]","0x402119"]]},{"orig":[["0x40568b","mov dword ptr [<OFFSET9>], eax"],["0x405690","call <OFFSET10>"],["0x405695","cmp dword ptr [<OFFSET11>], ebx"]],"recomp":[["0x40211b","mov dword ptr [__adjust_fdiv (UNK)], eax"],["0x402120","call __setargv (UNK)"],["0x402125","cmp dword ptr [___defaultmatherr (UNK)], ebx"]]},{"both":[["0x40569b","jne 0xc","0x40212b"]]},{"orig":[["0x40569d","push 0x4057a8"]],"recomp":[["0x40212d","push __matherr (UNK)"]]},{"both":[["0x4056a2","call dword ptr [->MSVCRT.dll::__setusermatherr (IMPORT)]","0x402132"],["0x4056a8","pop ecx","0x402138"]]},{"orig":[["0x4056a9","call <OFFSET13>"],["0x4056ae","push 0x51601c"],["0x4056b3","push 0x516018"],["0x4056b8","call <OFFSET14>"],["0x4056bd","mov eax, dword ptr [<OFFSET15>]"]],"recomp":[["0x402139","call __setdefaultprecision (UNK)"],["0x40213e","push ___xi_z (UNK)"],["0x402143","push ___xi_a (UNK)"],["0x402148","call MSVCRT.dll::_initterm (FUNCTION)"],["0x40214d","mov eax, dword ptr [__newmode (UNK)]"]]},{"both":[["0x4056c2","mov dword ptr [ebp - 0x6c], eax","0x402152"],["0x4056c5","lea eax, [ebp - 0x6c]","0x402155"],["0x4056c8","push eax","0x402158"]]},{"orig":[["0x4056c9","push dword ptr [<OFFSET16>]"]],"recomp":[["0x402159","push dword ptr [__dowildcard (UNK)]"]]},{"both":[["0x4056cf","lea eax, [ebp - 0x64]","0x40215f"],["0x4056d2","push eax","0x402162"],["0x4056d3","lea eax, [ebp - 0x70]","0x402163"],["0x4056d6","push eax","0x402166"],["0x4056d7","lea eax, [ebp - 0x60]","0x402167"],["0x4056da","push eax","0x40216a"],["0x4056db","call dword ptr [->MSVCRT.dll::__getmainargs (IMPORT)]","0x40216b"]]},{"orig":[["0x4056e1","push 0x516014"],["0x4056e6","push 0x516000"],["0x4056eb","call <OFFSET14>"]],"recomp":[["0x402171","push ___xc_z (UNK)"],["0x402176","push ___xc_a (UNK)"],["0x40217b","call MSVCRT.dll::_initterm (FUNCTION)"]]},{"both":[["0x4056f0","add esp, 0x24","0x402180"],["0x4056f3","mov eax, dword ptr [MSVCRT.dll::_acmdln (IMPORT)]","0x402183"],["0x4056f8","mov esi, dword ptr [eax]","0x402188"],["0x4056fa","mov dword ptr [ebp - 0x74], esi","0x40218a"],["0x4056fd","cmp byte ptr [esi], 0x22","0x40218d"],["0x405700","jne 0x3a","0x402190"],["0x405702","inc esi","0x402192"],["0x405703","mov dword ptr [ebp - 0x74], esi","0x402193"],["0x405706","mov al, byte ptr [esi]","0x402196"],["0x405708","cmp al, bl","0x402198"]]}]],["@@ -0x405742,27 +0x4021d2,27 @@",[{"both":[["0x405742","mov dword ptr [ebp - 0x74], esi","0x4021d2"],["0x405745","jmp -0xb","0x4021d5"],["0x405747","push 0xa","0x4021d7"],["0x405749","pop eax","0x4021d9"],["0x40574a","push eax","0x4021da"],["0x40574b","push esi","0x4021db"],["0x40574c","push ebx","0x4021dc"],["0x40574d","push ebx","0x4021dd"],["0x40574e","call dword ptr [->KERNEL32.dll::GetModuleHandleA (IMPORT)]","0x4021de"],["0x405754","push eax","0x4021e4"]]},{"orig":[["0x405755","call CMain::Initialize (FUNCTION)"]],"recomp":[["0x4021e5","call <OFFSET28>"]]},{"both":[["0x40575a","mov dword ptr [ebp - 0x68], eax","0x4021ea"],["0x40575d","push eax","0x4021ed"],["0x40575e","call dword ptr [->MSVCRT.dll::exit (IMPORT)]","0x4021ee"],["0x405764","mov eax, dword ptr [ebp - 0x14]","0x4021f4"],["0x405767","mov ecx, dword ptr [eax]","0x4021f7"],["0x405769","mov ecx, dword ptr [ecx]","0x4021f9"],["0x40576b","mov dword ptr [ebp - 0x78], ecx","0x4021fb"],["0x40576e","push eax","0x4021fe"],["0x40576f","push ecx","0x4021ff"]]},{"orig":[["0x405770","call <OFFSET23>"]],"recomp":[["0x402200","call MSVCRT.dll::_XcptFilter (FUNCTION)"]]},{"both":[["0x405775","pop ecx","0x402205"],["0x405776","pop ecx","0x402206"],["0x405777","ret ","0x402207"],["0x405778","mov esp, dword ptr [ebp - 0x18]","0x402208"],["0x40577b","push dword ptr [ebp - 0x78]","0x40220b"],["0x40577e","call dword ptr [->MSVCRT.dll::_exit (IMPORT)]","0x40220e"]]}]]]},{"address":"0x4057f0","name":"CGameInfo::GetGameLanguage","matching":1.0,"recomp":"0x401640"},{"address":"0x405800","name":"CGameInfo::GetGameRegion","matching":1.0,"recomp":"0x401660"},{"address":"0x405820","name":"CGameInfo::GetGameRegionDirectory","matching":1.0,"recomp":"0x401680"},{"address":"0x405c10","name":"CGameInfo::GetScreenWidth","matching":1.0,"recomp":"0x4016e0"},{"address":"0x405c20","name":"CGameInfo::SetScreenWidth","matching":1.0,"recomp":"0x401740"},{"address":"0x405c30","name":"CGameInfo::GetScreenHeight","matching":1.0,"recomp":"0x401700"},{"address":"0x405c40","name":"CGameInfo::SetScreenHeight","matching":1.0,"recomp":"0x401760"},{"address":"0x405c50","name":"CGameInfo::GetColourDepth","matching":1.0,"recomp":"0x401720"},{"address":"0x405c60","name":"CGameInfo::SetColourDepth","matching":1.0,"recomp":"0x401780"},{"address":"0x405d80","name":"CGameInfo::FUN_00405d80","matching":1.0,"recomp":"0x4016a0"},{"address":"0x406910","name":"RallyDataCountryIndex","matching":1.0,"recomp":"0x401cf0"},{"address":"0x406930","name":"RallyDataStageIndex","matching":1.0,"recomp":"0x401d10"},{"address":"0x4074f0","name":"RallyDataState","matching":1.0,"recomp":"0x401d30"},{"address":"0x407ec0","name":"CAIHelper::GetNameForID","matching":0.6296296296296297,"recomp":"0x401220","diff":[["@@ -0x407ec0,27 +0x401220,27 @@",[{"orig":[["0x407ec0","call CGameInfo::FUN_00405d80 (FUNCTION)"]],"recomp":[["0x401220","call <OFFSET1> \t(AIHelper.cpp:44)"]]},{"both":[["0x407ec5","cmp al, 5 \t(AIHelper.cpp:50)","0x401225"],["0x407ec7","je 0x2e","0x401227"]]},{"orig":[["0x407ec9","call CGameInfo::FUN_00405d80 (FUNCTION)"]],"recomp":[["0x401229","call <OFFSET1> \t(AIHelper.cpp:52)"]]},{"both":[["0x407ece","cmp al, 6","0x40122e"],["0x407ed0","je 0x25","0x401230"]]},{"orig":[["0x407ed2","call CGameInfo::FUN_00405d80 (FUNCTION)"]],"recomp":[["0x401232","call <OFFSET1> \t(AIHelper.cpp:54)"]]},{"both":[["0x407ed7","cmp al, 7","0x401237"],["0x407ed9","je 0x1c","0x401239"],["0x407edb","mov eax, dword ptr [esp + 4] \t(AIHelper.cpp:56)","0x40123b"],["0x407edf","test eax, eax","0x40123f"],["0x407ee1","jl 0x5","0x401241"],["0x407ee3","cmp eax, 0xf","0x401243"],["0x407ee6","jle 0x2","0x401246"],["0x407ee8","xor eax, eax \t(AIHelper.cpp:57)","0x401248"],["0x407eea","lea eax, [eax + eax*4] \t(AIHelper.cpp:59)","0x40124a"],["0x407eed","lea eax, [eax*4 + g_aiNames[0].[0] (DATA)]","0x40124d"],["0x407ef4","ret 4 \t(AIHelper.cpp:67)","0x401254"]]},{"orig":[["0x407ef7","call RallyDataState (FUNCTION)"],["0x407efc","mov cl, al"],["0x407efe","mov eax, dword ptr [esp + 4]"],["0x407f02","and ecx, 0xff"],["0x407f08","sub eax, ecx"],["0x407f0a","push eax"],["0x407f0b","call CAIHelper::FUN_00407f80 (FUNCTION)"]],"recomp":[["0x401257","call <OFFSET3> \t(AIHelper.cpp:64)"],["0x40125c","mov ecx, dword ptr [esp + 4] \t(AIHelper.cpp:65)"],["0x401260","and eax, 0xff \t(AIHelper.cpp:66)"],["0x401265","sub ecx, eax"],["0x401267","push ecx"],["0x401268","call <OFFSET4>"]]},{"both":[["0x407f10","lea edx, [eax + eax*4]","0x40126d"],["0x407f13","lea eax, [edx*4 + g_aiNames[0].[0] (DATA)]","0x401270"]]},{"orig":[],"recomp":[["0x401277","ret 4 \t(AIHelper.cpp:67)"]]}]]]},{"address":"0x407f80","name":"CAIHelper::FUN_00407f80","matching":1.0,"recomp":"0x4011d0"},{"address":"0x40d100","name":"RallyTiming_ResetOverallPlayerTimes","matching":0.7368421052631579,"recomp":"0x401de0","diff":[["@@ -0x40d100,9 +0x401de0,10 @@",[{"orig":[],"recomp":[["0x401de0","mov edx, dword ptr [unk0x533698 (DATA)] \t(RallyTiming.cpp:30)"]]},{"both":[["0x40d100","xor eax, eax","0x401de6"],["0x40d102","mov ecx, g_rallyOverallTimesRaw[0] (DATA)","0x401de8"],["0x40d107","mov dword ptr [ecx], 0 \t(RallyTiming.cpp:36)","0x401ded"],["0x40d10d","mov byte ptr [eax + g_rallyOverallOrderDriverID[0] (DATA)], al \t(RallyTiming.cpp:37)","0x401df3"],["0x40d113","add ecx, 4 \t(RallyTiming.cpp:39)","0x401df9"],["0x40d116","inc eax","0x401dfc"]]},{"orig":[["0x40d117","cmp ecx, unk0x533698 (DATA)"],["0x40d11d","jl -0x18"]],"recomp":[["0x401dfd","cmp ecx, edx"],["0x401dff","jb -0x14"]]},{"both":[["0x40d11f","ret  \t(RallyTiming.cpp:40)","0x401e01"]]}]]]},{"address":"0x40d390","name":"RallyTiming_GetOverallPositionDriverID","matching":1.0,"recomp":"0x401d90"},{"address":"0x40d3b0","name":"RallyTiming_GetOverallTimeForPosition","matching":0.3333333333333333,"recomp":"0x401db0","diff":[["@@ -0x40d3b0,6 +0x401db0,6 @@",[{"both":[["0x40d3b0","mov eax, dword ptr [esp + 4] \t(RallyTiming.cpp:21)","0x401db0"]]},{"orig":[["0x40d3b4","movsx eax, byte ptr [eax + g_rallyOverallOrderDriverID[0] (DATA)]"],["0x40d3bb","mov ecx, dword ptr [eax*4 + g_rallyOverallTimesRaw[0] (DATA)]"],["0x40d3c2","push ecx"],["0x40d3c3","call ConvertRawTimeToCentiseconds (FUNCTION)"]],"recomp":[["0x401db4","movsx ecx, byte ptr [eax + g_rallyOverallOrderDriverID[0] (DATA)]"],["0x401dbb","mov eax, dword ptr [ecx*4 + g_rallyOverallTimesRaw[0] (DATA)]"],["0x401dc2","push eax \t(RallyTiming.cpp:25)"],["0x401dc3","call <OFFSET3>"]]},{"both":[["0x40d3c8","ret 4 \t(RallyTiming.cpp:26)","0x401dc8"]]}]]]},{"address":"0x40d480","name":"ConvertRawTimeToCentiseconds","matching":0.13333333333333333,"recomp":"0x402000","diff":[["@@ -0x40d480,27 +0x402000,18 @@",[{"orig":[["0x40d480","push ebp"],["0x40d481","mov ebp, esp"],["0x40d483","mov eax, dword ptr [ebp + 8]"]],"recomp":[["0x402000","mov eax, dword ptr [esp + 4] \t(TimingUtils.cpp:16)"]]},{"both":[["0x40d486","add eax, 0x147","0x402004"]]},{"orig":[["0x40d48b","mov dword ptr [ebp + 8], eax"],["0x40d48e","mov eax, dword ptr [ebp + 8]"],["0x40d491","mov ecx, 0x28f5c28"],["0x40d496","cdq "],["0x40d497","shld edx, eax, 0x10"]],"recomp":[["0x402009","mov ecx, eax \t(TimingUtils.cpp:21)"],["0x40200b","mov edx, eax"],["0x40200d","sar ecx, 1"],["0x40200f","and edx, 0x80007fff"],["0x402015","or ecx, edx"],["0x402017","sar ecx, 0xf"]]},{"both":[["0x40d49b","shl eax, 0x10","0x40201a"]]},{"orig":[["0x40d49e","idiv ecx"],["0x40d4a0","pop ebp"]],"recomp":[["0x40201d","or ecx, eax"],["0x40201f","mov eax, 0x32000013"],["0x402024","imul ecx"],["0x402026","mov eax, edx"],["0x402028","sar eax, 0x17"],["0x40202b","mov ecx, eax"],["0x40202d","shr ecx, 0x1f"],["0x402030","add eax, ecx"]]},{"both":[["0x40d4a1","ret 4 \t(TimingUtils.cpp:22)","0x402032"]]},{"orig":[["0x40d4a4","nop "],["0x40d4a5","nop "],["0x40d4a6","nop "],["0x40d4a7","nop "],["0x40d4a8","nop "],["0x40d4a9","nop "],["0x40d4aa","nop "],["0x40d4ab","nop "],["0x40d4ac","nop "],["0x40d4ad","nop "],["0x40d4ae","nop "],["0x40d4af","nop "],["0x40d4b0","push ebp"],["0x40d4b1","mov ebp, esp"]],"recomp":[]}]]]},{"address":"0x40ed90","name":"CInstallInfo::GetFrontendDir","matching":1.0,"recomp":"0x4017c0"},{"address":"0x40eda0","name":"CInstallInfo::GetCountrySpecificDir","matching":1.0,"recomp":"0x4017e0"},{"address":"0x415bd0","name":"FormatGapToLeader","matching":0.0,"recomp":"0x401ec0","stub":true},{"address":"0x415db0","name":"PrepareFormatGapToLeader","matching":0.9512195121951219,"recomp":"0x401ee0","diff":[["@@ -0x415dcf,31 +0x401eff,31 @@",[{"both":[["0x415dcf","mov ecx, dword ptr [esp + 0x20]","0x401eff"],["0x415dd3","push edx","0x401f03"],["0x415dd4","mov edx, dword ptr [esp + 0x20]","0x401f04"],["0x415dd8","push eax","0x401f08"],["0x415dd9","mov eax, dword ptr [esp + 0x20]","0x401f09"],["0x415ddd","push ecx","0x401f0d"],["0x415dde","mov ecx, dword ptr [esp + 0x1c]","0x401f0e"],["0x415de2","push edx","0x401f12"],["0x415de3","push eax","0x401f13"],["0x415de4","push ecx","0x401f14"]]},{"orig":[["0x415de5","call FormatGapToLeader (FUNCTION)"]],"recomp":[["0x401f15","call <OFFSET2> \t(StageUI.cpp:23)"]]},{"both":[["0x415dea","ret 0x28 \t(StageUI.cpp:24)","0x401f1a"],["0x415ded","mov edx, dword ptr [esp + 0x28] \t(StageUI.cpp:23)","0x401f1d"],["0x415df1","mov eax, dword ptr [esp + 0x20]","0x401f21"],["0x415df5","mov ecx, dword ptr [esp + 0x1c]","0x401f25"],["0x415df9","push edx","0x401f29"],["0x415dfa","mov edx, dword ptr [esp + 0x1c]","0x401f2a"],["0x415dfe","push g_positiveSymbol[0] (DATA)","0x401f2e"],["0x415e03","push eax","0x401f33"],["0x415e04","mov eax, dword ptr [esp + 0x20]","0x401f34"],["0x415e08","push ecx","0x401f38"],["0x415e09","mov ecx, dword ptr [esp + 0x20]","0x401f39"],["0x415e0d","push edx","0x401f3d"],["0x415e0e","mov edx, dword ptr [esp + 0x20]","0x401f3e"],["0x415e12","push eax","0x401f42"],["0x415e13","mov eax, dword ptr [esp + 0x1c]","0x401f43"],["0x415e17","push ecx","0x401f47"],["0x415e18","push edx","0x401f48"],["0x415e19","push eax","0x401f49"]]},{"orig":[["0x415e1a","call FormatGapToLeader (FUNCTION)"]],"recomp":[["0x401f4a","call <OFFSET2>"]]},{"both":[["0x415e1f","ret 0x28 \t(StageUI.cpp:24)","0x401f4f"]]}]]]},{"address":"0x455cf0","name":"StageTiming_GetDriverIDForPosition","matching":0.8,"recomp":"0x401e40","diff":[["@@ -0x455cf0,5 +0x401e40,5 @@",[{"orig":[["0x455cf0","call GetStageSplitCount (FUNCTION)"]],"recomp":[["0x401e40","call <OFFSET1> \t(StageTiming.cpp:16)"]]},{"both":[["0x455cf5","mov ecx, dword ptr [esp + 4] \t(StageTiming.cpp:21)","0x401e45"],["0x455cf9","shl eax, 4","0x401e49"],["0x455cfc","movsx eax, byte ptr [eax + ecx + g_stageSplitDriverIndices[0].[0] (DATA)]","0x401e4c"],["0x455d04","ret 4 \t(StageTiming.cpp:22)","0x401e54"]]}]]]},{"address":"0x455d70","name":"StageTiming_GetTimeForPosition","matching":0.8888888888888888,"recomp":"0x401e70","diff":[["@@ -0x455d70,18 +0x401e70,18 @@",[{"both":[["0x455d70","push esi \t(StageTiming.cpp:26)","0x401e70"],["0x455d71","mov esi, dword ptr [esp + 8]","0x401e71"],["0x455d75","test esi, esi","0x401e75"],["0x455d77","jl 0x28","0x401e77"],["0x455d79","cmp esi, 0xf","0x401e79"],["0x455d7c","jg 0x23","0x401e7c"]]},{"orig":[["0x455d7e","call GetStageSplitCount (FUNCTION)"]],"recomp":[["0x401e7e","call <OFFSET1> \t(StageTiming.cpp:32)"]]},{"both":[["0x455d83","shl eax, 4 \t(StageTiming.cpp:33)","0x401e83"],["0x455d86","movsx ecx, byte ptr [eax + esi + g_stageSplitTimesRawDriverIx[0].[0] (DATA)]","0x401e86"],["0x455d8e","add ecx, eax","0x401e8e"],["0x455d90","mov eax, dword ptr [ecx*4 + g_stageSplitTimesRaw[0].[0] (DATA)]","0x401e90"],["0x455d97","push eax \t(StageTiming.cpp:34)","0x401e97"]]},{"orig":[["0x455d98","call ConvertRawTimeToCentiseconds (FUNCTION)"]],"recomp":[["0x401e98","call <OFFSET4>"]]},{"both":[["0x455d9d","pop esi","0x401e9d"],["0x455d9e","ret 4 \t(StageTiming.cpp:38)","0x401e9e"],["0x455da1","or eax, 0xffffffff \t(StageTiming.cpp:37)","0x401ea1"],["0x455da4","pop esi","0x401ea4"],["0x455da5","ret 4 \t(StageTiming.cpp:38)","0x401ea5"]]}]]]},{"address":"0x4583c0","name":"GetStageSplitCount","matching":1.0,"recomp":"0x401e20"},{"address":"0x49c0a0","name":"FUN_0049c0a0","matching":0.0,"recomp":"0x401b10","stub":true},{"address":"0x4a8140","name":"CMain::CreateGameWindow","matching":0.6492146596858639,"recomp":"0x401b30","diff":[["@@ -0x4a8140,93 +0x401b30,98 @@",[{"both":[["0x4a8140","sub esp, 0x28 \t(main.cpp:91)","0x401b30"],["0x4a8143","mov eax, dword ptr [esp + 0x38] \t(main.cpp:103)","0x401b33"]]},{"orig":[["0x4a8147","push ebx"]],"recomp":[["0x401b37","push ebp"],["0x401b38","mov ebp, dword ptr [esp + 0x30] \t(main.cpp:106)"]]},{"both":[["0x4a8148","push esi","0x401b3c"],["0x4a8149","push edi","0x401b3d"]]},{"orig":[["0x4a814a","mov edi, dword ptr [esp + 0x38]"]],"recomp":[["0x401b3e","xor edi, edi"]]},{"both":[["0x4a814e","push 0x6e \t(main.cpp:107)","0x401b40"]]},{"orig":[["0x4a8150","push edi"]],"recomp":[["0x401b42","push ebp"]]},{"both":[["0x4a8151","mov dword ptr [esp + 0x18], eax","0x401b43"]]},{"orig":[["0x4a8155","mov dword ptr [esp + 0x1c], 0"],["0x4a815d","mov dword ptr [esp + 0x20], 0"],["0x4a8165","mov dword ptr [esp + 0x24], edi"]],"recomp":[["0x401b47","mov dword ptr [esp + 0x1c], edi"],["0x401b4b","mov dword ptr [esp + 0x20], edi"],["0x401b4f","mov dword ptr [esp + 0x24], ebp"]]},{"both":[["0x4a8169","call dword ptr [->USER32.dll::LoadIconA (IMPORT)]","0x401b53"],["0x4a816f","push 4 \t(main.cpp:108)","0x401b59"],["0x4a8171","mov dword ptr [esp + 0x24], eax","0x401b5b"],["0x4a8175","call dword ptr [->GDI32.dll::GetStockObject (IMPORT)]","0x401b5f"],["0x4a817b","mov ecx, dword ptr [g_pGraphics (DATA)] \t(main.cpp:114)","0x401b65"],["0x4a8181","mov dword ptr [esp + 0x2c], g_lpszMenuName[0] (DATA)","0x401b6b"],["0x4a8189","mov esi, dword ptr [esp + 0x40]","0x401b73"],["0x4a818d","mov dword ptr [esp + 0x28], eax","0x401b77"],["0x4a8191","mov dword ptr [esp + 0x30], esi","0x401b7b"],["0x4a8195","mov dword ptr [esp + 0xc], 3","0x401b7f"]]},{"orig":[["0x4a819d","mov eax, dword ptr [ecx + 0x1c]"],["0x4a81a0","test eax, eax"],["0x4a81a2","jne 0x18"]],"recomp":[["0x401b87","cmp dword ptr [ecx + 0x1c], edi"],["0x401b8a","jne 0x12"]]},{"both":[["0x4a81a4","push 0x7f00 \t(main.cpp:115)","0x401b8c"]]},{"orig":[["0x4a81a9","push 0"]],"recomp":[["0x401b91","push edi"]]},{"both":[["0x4a81ab","call dword ptr [->USER32.dll::LoadCursorA (IMPORT)]","0x401b92"]]},{"orig":[["0x4a81b1","mov ebx, 0x81cf0000"]],"recomp":[]},{"both":[["0x4a81b6","mov dword ptr [esp + 0x24], eax","0x401b98"]]},{"orig":[["0x4a81ba","jmp 0xa"],["0x4a81bc","mov dword ptr [esp + 0x24], 0"],["0x4a81c4","xor ebx, ebx"]],"recomp":[["0x401b9c","jmp 0x4 \t(main.cpp:116)"],["0x401b9e","mov dword ptr [esp + 0x24], edi \t(main.cpp:117)"]]},{"both":[["0x4a81c6","lea edx, [esp + 0xc] \t(main.cpp:119)","0x401ba2"],["0x4a81ca","push edx","0x401ba6"],["0x4a81cb","call dword ptr [->USER32.dll::RegisterClassA (IMPORT)]","0x401ba7"],["0x4a81d1","test ax, ax \t(main.cpp:120)","0x401bad"],["0x4a81d4","jne 0xb","0x401bb0"],["0x4a81d6","pop edi","0x401bb2"],["0x4a81d7","pop esi","0x401bb3"],["0x4a81d8","xor eax, eax \t(main.cpp:121)","0x401bb4"]]},{"orig":[["0x4a81da","pop ebx"]],"recomp":[["0x401bb6","pop ebp"]]},{"both":[["0x4a81db","add esp, 0x28 \t(main.cpp:147)","0x401bb7"],["0x4a81de","ret 0x10","0x401bba"]]},{"orig":[],"recomp":[["0x401bbd","mov edi, dword ptr [USER32.dll::GetSystemMetrics (IMPORT)] \t(main.cpp:126)"],["0x401bc3","push ebx"],["0x401bc4","push 1"],["0x401bc6","call edi"]]},{"both":[["0x4a81e1","push 0 \t(main.cpp:127)","0x401bc8"]]},{"orig":[["0x4a81e3","push edi"],["0x4a81e4","mov edi, dword ptr [USER32.dll::GetSystemMetrics (IMPORT)]"]],"recomp":[["0x401bca","mov ebx, eax"],["0x401bcc","call edi"],["0x401bce","push 0 \t(main.cpp:130)"],["0x401bd0","push ebp"]]},{"both":[["0x4a81ea","push 0","0x401bd1"],["0x4a81ec","push 0","0x401bd3"]]},{"orig":[["0x4a81ee","push 1"],["0x4a81f0","call edi"],["0x4a81f2","push eax"],["0x4a81f3","push 0"],["0x4a81f5","call edi"]],"recomp":[["0x401bd5","push ebx"]]},{"both":[["0x4a81f7","push eax","0x401bd6"],["0x4a81f8","push 0","0x401bd7"],["0x4a81fa","push 0","0x401bd9"]]},{"orig":[["0x4a81fc","push ebx"]],"recomp":[["0x401bdb","push 0x81cf0000"]]},{"both":[["0x4a81fd","push esi","0x401be0"],["0x4a81fe","push esi","0x401be1"],["0x4a81ff","push 0x40000","0x401be2"],["0x4a8204","call dword ptr [->USER32.dll::CreateWindowExA (IMPORT)]","0x401be7"],["0x4a820a","mov esi, eax","0x401bed"],["0x4a820c","mov eax, dword ptr [g_hWndIx (DATA)] \t(main.cpp:132)","0x401bef"],["0x4a8211","test esi, esi \t(main.cpp:133)","0x401bf4"],["0x4a8213","mov dword ptr [eax*4 + g_hWndList[0] (DATA)], esi","0x401bf6"]]},{"orig":[],"recomp":[["0x401bfd","pop ebx"]]},{"both":[["0x4a821a","jne 0xb","0x401bfe"],["0x4a821c","pop edi","0x401c00"],["0x4a821d","pop esi","0x401c01"],["0x4a821e","xor eax, eax \t(main.cpp:134)","0x401c02"]]},{"orig":[["0x4a8220","pop ebx"]],"recomp":[["0x401c04","pop ebp"]]},{"both":[["0x4a8221","add esp, 0x28 \t(main.cpp:147)","0x401c05"],["0x4a8224","ret 0x10","0x401c08"],["0x4a8227","mov ecx, dword ptr [g_pGraphics (DATA)] \t(main.cpp:136)","0x401c0b"],["0x4a822d","mov eax, dword ptr [ecx + 0x1c]","0x401c11"]]},{"orig":[["0x4a8230","test eax, eax"],["0x4a8232","jne 0x4"],["0x4a8234","push 0"],["0x4a8236","jmp 0x2"],["0x4a8238","push 3"]],"recomp":[["0x401c14","neg eax"],["0x401c16","sbb eax, eax"],["0x401c18","and al, 0xf9"],["0x401c1a","add eax, 0xa"],["0x401c1d","push eax \t(main.cpp:141)"]]},{"both":[["0x4a823a","push esi","0x401c1e"],["0x4a823b","call dword ptr [->USER32.dll::ShowWindow (IMPORT)]","0x401c1f"],["0x4a8241","push esi \t(main.cpp:142)","0x401c25"],["0x4a8242","call dword ptr [->USER32.dll::UpdateWindow (IMPORT)]","0x401c26"],["0x4a8248","push esi \t(main.cpp:143)","0x401c2c"],["0x4a8249","call dword ptr [->USER32.dll::SetFocus (IMPORT)]","0x401c2d"],["0x4a824f","push 0 \t(main.cpp:145)","0x401c33"]]},{"orig":[["0x4a8251","push FUN_004a8270 (FUNCTION)"]],"recomp":[["0x401c35","push <OFFSET14>"]]},{"both":[["0x4a8256","mov edx, dword ptr [esp + 0x44]","0x401c3a"],["0x4a825a","mov dword ptr [edx], esi","0x401c3e"]]},{"orig":[["0x4a825c","call FUN_0049c0a0 (FUNCTION)"]],"recomp":[["0x401c40","call <OFFSET15>"]]},{"both":[["0x4a8261","pop edi","0x401c45"],["0x4a8262","pop esi","0x401c46"]]},{"orig":[],"recomp":[["0x401c47","mov eax, 1 \t(main.cpp:146)"],["0x401c4c","pop ebp"],["0x401c4d","add esp, 0x28 \t(main.cpp:147)"],["0x401c50","ret 0x10"]]}]]]},{"address":"0x4a8270","name":"FUN_004a8270","matching":0.0,"recomp":"0x401af0","stub":true},{"address":"0x4a9700","name":"CFrontend::FUN_004a9700","matching":1.0,"recomp":"0x401610"},{"address":"0x4a9720","name":"CMain::Initialize","matching":0.18823529411764706,"recomp":"0x401970","diff":[["@@ -0x4a9720,82 +0x401970,88 @@",[{"orig":[],"recomp":[["0x401970","sub esp, 0x1c \t(main.cpp:31)"]]},{"both":[["0x4a9720","push CMain::m_gameName[0] (DATA) \t(main.cpp:33)","0x401973"],["0x4a9725","push CMain::m_gameName[0] (DATA)","0x401978"],["0x4a972a","call dword ptr [->USER32.dll::FindWindowA (IMPORT)]","0x40197d"],["0x4a9730","test eax, eax \t(main.cpp:34)","0x401983"]]},{"orig":[["0x4a9732","je 0x5"],["0x4a9734","xor eax, eax"],["0x4a9736","ret 0x10"],["0x4a9739","push esi"]],"recomp":[["0x401985","je 0x6"],["0x401987","xor al, al \t(main.cpp:35)"],["0x401989","add esp, 0x1c \t(main.cpp:73)"],["0x40198c","ret "],["0x40198d","push edi"]]},{"both":[["0x4a973a","push CMain::m_logFileLocation[0] (DATA) \t(main.cpp:37)","0x40198e"]]},{"orig":[["0x4a973f","call CLogger::OpenLogFile (FUNCTION)"]],"recomp":[["0x401993","call <OFFSET4>"]]},{"both":[["0x4a9744","push CMain::m_logFileHeader1[0] (DATA) \t(main.cpp:38)","0x401998"]]},{"orig":[["0x4a9749","call CLogger::LogToFile (FUNCTION)"]],"recomp":[["0x40199d","call <OFFSET6>"]]},{"both":[["0x4a974e","push CMain::m_logFileAsterisks[0] (DATA) \t(main.cpp:39)","0x4019a2"]]},{"orig":[["0x4a9753","call CLogger::LogToFile (FUNCTION)"]],"recomp":[["0x4019a7","call <OFFSET6>"]]},{"both":[["0x4a9758","push CMain::m_logFileBlankLine[0] (DATA) \t(main.cpp:40)","0x4019ac"]]},{"orig":[["0x4a975d","call CLogger::LogToFile (FUNCTION)"],["0x4a9762","mov esi, dword ptr [esp + 8]"],["0x4a9766","mov dword ptr [g_hInstance (DATA)], esi"],["0x4a976c","call <OFFSET10>"],["0x4a9771","call <OFFSET11>"],["0x4a9776","call <OFFSET12>"],["0x4a977b","mov eax, dword ptr [esp + 0x10]"]],"recomp":[["0x4019b1","call <OFFSET6>"],["0x4019b6","mov ecx, dword ptr [g_hWndIx (DATA)] \t(main.cpp:43)"],["0x4019bc","mov eax, dword ptr [esp + 0x24]"],["0x4019c0","push <OFFSET10>"],["0x4019c5","push CMain::m_gameName[0] (DATA)"],["0x4019ca","lea edx, [ecx*4 + g_hWndList[0] (DATA)]"],["0x4019d1","mov dword ptr [g_hInstance (DATA)], eax"],["0x4019d6","push edx"]]},{"both":[["0x4a977f","push eax","0x4019d7"],["0x4a9780","call <OFFSET13>","0x4019d8"]]},{"orig":[["0x4a9785","mov ecx, dword ptr [g_hWndIx (DATA)]"],["0x4a978b","push CMain::MessageHandler (FUNCTION)"],["0x4a9790","push CMain::m_gameName[0] (DATA)"],["0x4a9795","lea edx, [ecx*4 + g_hWndList[0] (DATA)]"]],"recomp":[["0x4019dd","mov edi, dword ptr [USER32.dll::GetMessageA (IMPORT)] \t(main.cpp:46)"],["0x4019e3","push 0"],["0x4019e5","push 0"],["0x4019e7","lea eax, [esp + 0xc]"],["0x4019eb","push 0"],["0x4019ed","push eax"],["0x4019ee","call edi"],["0x4019f0","test eax, eax"],["0x4019f2","je 0x6e"],["0x4019f4","push ebx"],["0x4019f5","mov ebx, dword ptr [USER32.dll::TranslateMessage (IMPORT)]"],["0x4019fb","push ebp"],["0x4019fc","mov ebp, dword ptr [USER32.dll::DispatchMessageA (IMPORT)]"],["0x401a02","push esi"],["0x401a03","mov esi, dword ptr [USER32.dll::ShowCursor (IMPORT)]"],["0x401a09","lea ecx, [esp + 0x10] \t(main.cpp:48)"],["0x401a0d","push ecx"],["0x401a0e","call ebx"],["0x401a10","lea edx, [esp + 0x10] \t(main.cpp:49)"]]},{"both":[["0x4a979c","push edx","0x401a14"]]},{"orig":[["0x4a979d","push esi"],["0x4a979e","call CMain::CreateGameWindow (FUNCTION)"],["0x4a97a3","mov eax, dword ptr [<OFFSET18>]"],["0x4a97a8","xor esi, esi"],["0x4a97aa","cmp eax, esi"],["0x4a97ac","jne 0xb4"],["0x4a97b2","push ebx"],["0x4a97b3","mov ebx, dword ptr [USER32.dll::PeekMessageA (IMPORT)]"],["0x4a97b9","push ebp"],["0x4a97ba","mov ebp, dword ptr [USER32.dll::GetMessageA (IMPORT)]"],["0x4a97c0","push edi"],["0x4a97c1","mov edi, dword ptr [USER32.dll::ShowCursor (IMPORT)]"],["0x4a97c7","cmp dword ptr [<OFFSET22>], esi"],["0x4a97cd","jne 0xe"],["0x4a97cf","push 1"],["0x4a97d1","push esi"],["0x4a97d2","push esi"],["0x4a97d3","push esi"],["0x4a97d4","push 0x663c68"],["0x4a97d9","call ebx"],["0x4a97db","jmp 0xa"],["0x4a97dd","push esi"],["0x4a97de","push esi"],["0x4a97df","push esi"],["0x4a97e0","push 0x663c68"]],"recomp":[]},{"both":[["0x4a97e5","call ebp","0x401a15"]]},{"orig":[["0x4a97e7","mov ecx, dword ptr [<OFFSET23>]"],["0x4a97ed","cmp ecx, 0x1c"],["0x4a97f0","je 0x21"],["0x4a97f2","cmp eax, esi"],["0x4a97f4","je 0x1d"],["0x4a97f6","cmp ecx, 0x12"],["0x4a97f9","je 0x68"],["0x4a97fb","push 0x663c68"],["0x4a9800","call dword ptr [->USER32.dll::TranslateMessage (IMPORT)]"],["0x4a9806","push 0x663c68"],["0x4a980b","call dword ptr [->USER32.dll::DispatchMessageA (IMPORT)]"],["0x4a9811","jmp 0x12"],["0x4a9813","cmp dword ptr [<OFFSET22>], esi"],["0x4a9819","jne 0xa"],["0x4a981b","call <OFFSET26>"],["0x4a9820","call <OFFSET27>"]],"recomp":[]},{"both":[["0x4a9825","mov eax, dword ptr [g_pGraphics (DATA)] \t(main.cpp:51)","0x401a17"],["0x4a982a","mov ecx, dword ptr [eax + 0x1c]","0x401a1c"],["0x4a982d","mov eax, dword ptr [CMain::m_isShowingCursor (DATA)] \t(main.cpp:53)","0x401a1f"]]},{"orig":[["0x4a9832","cmp ecx, esi"],["0x4a9834","je 0xf"],["0x4a9836","cmp eax, esi"],["0x4a9838","je 0x1d"],["0x4a983a","push esi"]],"recomp":[["0x401a24","test ecx, ecx"],["0x401a26","jne 0x14"],["0x401a28","test eax, eax"],["0x401a2a","jne 0x22"],["0x401a2c","push 1 \t(main.cpp:55)"],["0x401a2e","call esi"],["0x401a30","mov dword ptr [CMain::m_isShowingCursor (DATA)], 1 \t(main.cpp:56)"],["0x401a3a","jmp 0x12 \t(main.cpp:59)"],["0x401a3c","test eax, eax"],["0x401a3e","je 0xe"],["0x401a40","push 0 \t(main.cpp:61)"],["0x401a42","call esi"],["0x401a44","mov dword ptr [CMain::m_isShowingCursor (DATA)], 0 \t(main.cpp:62)"],["0x401a4e","push 0"],["0x401a50","push 0"],["0x401a52","lea ecx, [esp + 0x18]"],["0x401a56","push 0"],["0x401a58","push ecx"]]},{"both":[["0x4a983b","call edi","0x401a59"]]},{"orig":[["0x4a983d","mov dword ptr [CMain::m_isShowingCursor (DATA)], esi"],["0x4a9843","jmp 0x12"]],"recomp":[["0x401a5b","test eax, eax"],["0x401a5d","jne -0x56"],["0x401a5f","pop esi"],["0x401a60","pop ebp"],["0x401a61","pop ebx"],["0x401a62","push CMain::m_logFileBlankLine[0] (DATA) \t(main.cpp:66)"],["0x401a67","call <OFFSET6>"],["0x401a6c","push CMain::m_logFileAsterisks[0] (DATA) \t(main.cpp:67)"],["0x401a71","call <OFFSET6>"],["0x401a76","push CMain::m_logFileFinishedNormally[0] (DATA) \t(main.cpp:68)"],["0x401a7b","call <OFFSET6>"],["0x401a80","push CMain::m_logFileAsterisks[0] (DATA) \t(main.cpp:69)"],["0x401a85","call <OFFSET6>"],["0x401a8a","call <OFFSET21> \t(main.cpp:70)"],["0x401a8f","xor al, al \t(main.cpp:72)"],["0x401a91","pop edi"],["0x401a92","add esp, 0x1c \t(main.cpp:73)"],["0x401a95","ret "]]}]]]},{"address":"0x4a98b0","name":"CMain::MessageHandler","matching":0.13793103448275862,"recomp":"0x401cb0","diff":[["@@ -0x4a98b0,12 +0x401cb0,17 @@",[{"both":[["0x4a98b0","push esi \t(main.cpp:151)","0x401cb0"],["0x4a98b1","mov esi, dword ptr [esp + 0xc]","0x401cb1"]]},{"orig":[["0x4a98b5","push edi"],["0x4a98b6","mov edi, dword ptr [esp + 0x18]"],["0x4a98ba","cmp esi, 0x1c"],["0x4a98bd","ja 0xc4"],["0x4a98c3","cmp esi, 0x1c"],["0x4a98c6","je 0x83"],["0x4a98cc","lea eax, [esi - 2]"],["0x4a98cf","cmp eax, 0xe"],["0x4a98d2","ja 0xf6"],["0x4a98d8","xor ecx, ecx"]],"recomp":[["0x401cb5","mov eax, esi"],["0x401cb7","sub eax, 2"],["0x401cba","jne 0x8"],["0x401cbc","push 0 \t(main.cpp:173)"],["0x401cbe","call dword ptr [->USER32.dll::PostQuitMessage (IMPORT)]"],["0x401cc4","mov eax, dword ptr [esp + 0x14] \t(main.cpp:177)"],["0x401cc8","mov ecx, dword ptr [esp + 0x10]"],["0x401ccc","mov edx, dword ptr [esp + 8]"],["0x401cd0","push eax"],["0x401cd1","push ecx"],["0x401cd2","push esi"],["0x401cd3","push edx"],["0x401cd4","call dword ptr [->USER32.dll::DefWindowProcA (IMPORT)]"],["0x401cda","pop esi"],["0x401cdb","ret 0x10 \t(main.cpp:178)"]]}]]]},{"address":"0x4a9d70","name":"CGenericFileLoader::FUN_004a9d70","matching":0.0,"recomp":"0x4017a0","stub":true},{"address":"0x4aad70","name":"AllocateLockedBuffer","matching":1.0,"recomp":"0x4012a0"},{"address":"0x4aad90","name":"ReallocateLockedBuffer","matching":0.9629629629629629,"recomp":"0x4012d0","diff":[["@@ -0x4aadb2,13 +0x4012f2,13 @@",[{"both":[["0x4aadb2","call edi","0x4012f2"],["0x4aadb4","push eax","0x4012f4"],["0x4aadb5","call dword ptr [->KERNEL32.dll::GlobalReAlloc (IMPORT)]","0x4012f5"],["0x4aadbb","push eax \t(FileBuffer.cpp:27)","0x4012fb"],["0x4aadbc","call dword ptr [->KERNEL32.dll::GlobalLock (IMPORT)]","0x4012fc"],["0x4aadc2","pop edi","0x401302"],["0x4aadc3","pop esi","0x401303"],["0x4aadc4","ret 8 \t(FileBuffer.cpp:32)","0x401304"],["0x4aadc7","mov ecx, dword ptr [esp + 0xc] \t(FileBuffer.cpp:30)","0x401307"],["0x4aadcb","push ecx","0x40130b"]]},{"orig":[["0x4aadcc","call AllocateLockedBuffer (FUNCTION)"]],"recomp":[["0x40130c","call <OFFSET5>"]]},{"both":[["0x4aadd1","pop esi","0x401311"],["0x4aadd2","ret 8 \t(FileBuffer.cpp:32)","0x401312"]]}]]]},{"address":"0x4aade0","name":"FreeGenericFileBuffer","matching":1.0,"recomp":"0x401340"},{"address":"0x4ab620","name":"CLogger::OpenLogFile","matching":1.0,"recomp":"0x401800"},{"address":"0x4ab670","name":"CLogger::LogToFile","matching":1.0,"recomp":"0x401870"},{"address":"0x4ab6f0","name":"CLogger::CloseLogFile","matching":1.0,"recomp":"0x401910"},{"address":"0x4b7560","name":"CFrontend::FUN_004b7560","matching":1.0,"recomp":"0x401590","effective":true,"diff":[["@@ -0x4b7560,10 +0x401590,10 @@",[{"both":[["0x4b7560","mov eax, dword ptr [esp + 4] \t(Frontend.cpp:108)","0x401590"],["0x4b7564","mov ecx, dword ptr [CFrontend::m_unk0x006e0c5c (DATA)]","0x401594"]]},{"orig":[["0x4b756a","cmp eax, ecx"],["0x4b756c","jb 0x10"]],"recomp":[["0x40159a","cmp ecx, eax"],["0x40159c","ja 0x10"]]},{"both":[["0x4b756e","cmp eax, dword ptr [CFrontend::m_unk0x006e0c64 (DATA)]","0x40159e"],["0x4b7574","ja 0x8","0x4015a4"],["0x4b7576","mov eax, 1 \t(Frontend.cpp:110)","0x4015a6"],["0x4b757b","ret 4 \t(Frontend.cpp:113)","0x4015ab"],["0x4b757e","xor eax, eax \t(Frontend.cpp:112)","0x4015ae"],["0x4b7580","ret 4 \t(Frontend.cpp:113)","0x4015b0"]]}]]]},{"address":"0x4b7590","name":"CFrontend::FUN_004b7590","matching":1.0,"recomp":"0x4015d0","effective":true,"diff":[["@@ -0x4b7590,10 +0x4015d0,10 @@",[{"both":[["0x4b7590","mov eax, dword ptr [esp + 4] \t(Frontend.cpp:117)","0x4015d0"],["0x4b7594","mov ecx, dword ptr [CFrontend::m_unk0x006e0c60 (DATA)]","0x4015d4"]]},{"orig":[["0x4b759a","cmp eax, ecx"],["0x4b759c","jb 0x10"]],"recomp":[["0x4015da","cmp ecx, eax"],["0x4015dc","ja 0x10"]]},{"both":[["0x4b759e","cmp eax, dword ptr [CFrontend::m_unk0x006e0c68 (DATA)]","0x4015de"],["0x4b75a4","ja 0x8","0x4015e4"],["0x4b75a6","mov eax, 1 \t(Frontend.cpp:119)","0x4015e6"],["0x4b75ab","ret 4 \t(Frontend.cpp:122)","0x4015eb"],["0x4b75ae","xor eax, eax \t(Frontend.cpp:121)","0x4015ee"],["0x4b75b0","ret 4 \t(Frontend.cpp:122)","0x4015f0"]]}]]]},{"address":"0x4d21e0","name":"CFrontend::FUN_004d21e0","matching":0.5968992248062015,"recomp":"0x401380","diff":[["@@ -0x4d21e0,131 +0x401380,127 @@",[{"both":[["0x4d21e0","mov eax, dword ptr [CGenericFileLoader::m_genericFile (DATA)] \t(Frontend.cpp:29)","0x401380"],["0x4d21e5","push ebx","0x401385"],["0x4d21e6","push esi","0x401386"]]},{"orig":[["0x4d21e7","xor esi, esi"],["0x4d21e9","cmp eax, esi"]],"recomp":[["0x401387","push edi"],["0x401388","xor edi, edi"],["0x40138a","cmp eax, edi"]]},{"both":[["0x4d21eb","je 0xc","0x40138c"],["0x4d21ed","push eax \t(Frontend.cpp:35)","0x40138e"]]},{"orig":[["0x4d21ee","call FreeGenericFileBuffer (FUNCTION)"],["0x4d21f3","mov dword ptr [CGenericFileLoader::m_genericFile (DATA)], esi"],["0x4d21f9","mov dword ptr [CGenericFileLoader::m_genericFile+8 (OFFSET)], esi"],["0x4d21ff","mov dword ptr [CGenericFileLoader::m_genericFile+4 (OFFSET)], esi"],["0x4d2205","call CGameInfo::GetScreenWidth (FUNCTION)"]],"recomp":[["0x40138f","call <OFFSET2>"],["0x401394","mov dword ptr [CGenericFileLoader::m_genericFile (DATA)], edi \t(Frontend.cpp:36)"],["0x40139a","mov dword ptr [CGenericFileLoader::m_genericFile+8 (OFFSET)], edi \t(Frontend.cpp:39)"],["0x4013a0","mov dword ptr [CGenericFileLoader::m_genericFile+4 (OFFSET)], edi \t(Frontend.cpp:40)"],["0x4013a6","call <OFFSET5> \t(Frontend.cpp:42)"],["0x4013ab","mov esi, dword ptr [MSVCRT.dll::sprintf (IMPORT)]"]]},{"both":[["0x4d220a","cmp eax, 0x400","0x4013b1"],["0x4d220f","jb 0x3f","0x4013b6"],["0x4d2211","push 0x400 \t(Frontend.cpp:44)","0x4013b8"]]},{"orig":[["0x4d2216","call CFrontend::FUN_004b7560 (FUNCTION)"]],"recomp":[["0x4013bd","call <OFFSET7>"]]},{"both":[["0x4d221b","test eax, eax","0x4013c2"]]},{"orig":[["0x4d221d","je 0x31"]],"recomp":[["0x4013c4","je 0x5c"]]},{"both":[["0x4d221f","push 0x400 \t(Frontend.cpp:46)","0x4013c6"]]},{"orig":[["0x4d2224","call CFrontend::FUN_004b7590 (FUNCTION)"]],"recomp":[["0x4013cb","call <OFFSET8>"]]},{"both":[["0x4d2229","test eax, eax","0x4013d0"]]},{"orig":[["0x4d222b","je 0x23"],["0x4d222d","call CFrontend::FUN_004a9700 (FUNCTION)"]],"recomp":[["0x4013d2","je 0x4e"],["0x4013d4","call <OFFSET9> \t(Frontend.cpp:48)"]]},{"both":[["0x4d2232","test eax, eax","0x4013d9"],["0x4d2234","je 0xd","0x4013db"]]},{"orig":[["0x4d2236","call CInstallInfo::GetFrontendDir (FUNCTION)"]],"recomp":[["0x4013dd","call <OFFSET10> \t(Frontend.cpp:49)"]]},{"both":[["0x4d223b","push eax","0x4013e2"],["0x4d223c","push CFrontend::m_feRes1024C[0] (DATA)","0x4013e3"],["0x4d2241","jmp 0x2e \t(Frontend.cpp:51)","0x4013e8"]]},{"orig":[["0x4d2243","call CInstallInfo::GetFrontendDir (FUNCTION)"]],"recomp":[["0x4013ea","call <OFFSET10> \t(Frontend.cpp:52)"]]},{"both":[["0x4d2248","push eax","0x4013ef"],["0x4d2249","push CFrontend::m_feRes1024[0] (DATA)","0x4013f0"],["0x4d224e","jmp 0x21 \t(Frontend.cpp:56)","0x4013f5"]]},{"orig":[["0x4d2250","call CFrontend::FUN_004a9700 (FUNCTION)"]],"recomp":[["0x4013f7","call <OFFSET9> \t(Frontend.cpp:59)"]]},{"both":[["0x4d2255","test eax, eax","0x4013fc"],["0x4d2257","je 0xd","0x4013fe"]]},{"orig":[["0x4d2259","call CInstallInfo::GetFrontendDir (FUNCTION)"]],"recomp":[["0x401400","call <OFFSET10> \t(Frontend.cpp:60)"]]},{"both":[["0x4d225e","push eax","0x401405"],["0x4d225f","push CFrontend::m_feRes640C[0] (DATA)","0x401406"],["0x4d2264","jmp 0xb \t(Frontend.cpp:61)","0x40140b"]]},{"orig":[["0x4d2266","call CInstallInfo::GetFrontendDir (FUNCTION)"]],"recomp":[["0x40140d","call <OFFSET10> \t(Frontend.cpp:62)"]]},{"both":[["0x4d226b","push eax","0x401412"],["0x4d226c","push CFrontend::m_feRes640[0] (DATA)","0x401413"],["0x4d2271","push CFrontend::m_stringDest[0] (DATA)","0x401418"]]},{"orig":[["0x4d2276","call <OFFSET15>"]],"recomp":[["0x40141d","call esi"]]},{"both":[["0x4d227b","add esp, 0xc","0x40141f"],["0x4d227e","push CFrontend::m_stringDest[0] (DATA) \t(Frontend.cpp:65)","0x401422"],["0x4d2283","push CGenericFileLoader::m_genericFile (DATA)","0x401427"]]},{"orig":[["0x4d2288","call CGenericFileLoader::FUN_004a9d70 (FUNCTION)"]],"recomp":[["0x40142c","call <OFFSET16>"]]},{"both":[["0x4d228d","mov eax, dword ptr [CFrontend::m_unk0x00818260 (DATA)] \t(Frontend.cpp:66)","0x401431"]]},{"orig":[["0x4d2292","cmp eax, esi"]],"recomp":[["0x401436","cmp eax, edi"]]},{"both":[["0x4d2294","je 0xc","0x401438"],["0x4d2296","push eax \t(Frontend.cpp:68)","0x40143a"]]},{"orig":[["0x4d2297","call FreeGenericFileBuffer (FUNCTION)"],["0x4d229c","mov dword ptr [CFrontend::m_unk0x00818260 (DATA)], esi"],["0x4d22a2","mov dword ptr [CFrontend::m_unk0x00818260+8 (OFFSET)], esi"],["0x4d22a8","mov dword ptr [CFrontend::m_unk0x00818260+4 (OFFSET)], esi"],["0x4d22ae","call CGameInfo::GetGameRegion (FUNCTION)"],["0x4d22b3","sub eax, esi"],["0x4d22b5","je 0x8"]],"recomp":[["0x40143b","call <OFFSET2>"],["0x401440","mov dword ptr [CFrontend::m_unk0x00818260 (DATA)], edi \t(Frontend.cpp:69)"],["0x401446","mov dword ptr [CFrontend::m_unk0x00818260+8 (OFFSET)], edi \t(Frontend.cpp:71)"],["0x40144c","mov dword ptr [CFrontend::m_unk0x00818260+4 (OFFSET)], edi \t(Frontend.cpp:72)"],["0x401452","call <OFFSET20> \t(Frontend.cpp:76)"],["0x401457","cmp eax, edi \t(Frontend.cpp:77)"],["0x401459","je 0xa"]]},{"both":[["0x4d22b7","dec eax","0x40145b"]]},{"orig":[["0x4d22b8","je 0x5"]],"recomp":[["0x40145c","je 0x7"]]},{"both":[["0x4d22ba","dec eax","0x40145e"],["0x4d22bb","mov bl, 0x50 \t(Frontend.cpp:78)","0x40145f"]]},{"orig":[],"recomp":[["0x401461","test eax, eax"]]},{"both":[["0x4d22bd","jne 0x2","0x401463"],["0x4d22bf","mov bl, 0x45 \t(Frontend.cpp:80)","0x401465"]]},{"orig":[["0x4d22c1","call CGameInfo::GetScreenWidth (FUNCTION)"]],"recomp":[["0x401467","call <OFFSET5> \t(Frontend.cpp:82)"]]},{"both":[["0x4d22c6","cmp eax, 0x400","0x40146c"]]},{"orig":[["0x4d22cb","jb 0x53"]],"recomp":[["0x401471","jb 0x57"]]},{"both":[["0x4d22cd","push 0x400 \t(Frontend.cpp:84)","0x401473"]]},{"orig":[["0x4d22d2","call CFrontend::FUN_004b7560 (FUNCTION)"]],"recomp":[["0x401478","call <OFFSET7>"]]},{"both":[["0x4d22d7","test eax, eax","0x40147d"]]},{"orig":[["0x4d22d9","je 0x45"]],"recomp":[["0x40147f","je 0x84"]]},{"both":[["0x4d22db","push 0x400 \t(Frontend.cpp:86)","0x401485"]]},{"orig":[["0x4d22e0","call CFrontend::FUN_004b7590 (FUNCTION)"]],"recomp":[["0x40148a","call <OFFSET8>"]]},{"both":[["0x4d22e5","test eax, eax","0x40148f"]]},{"orig":[["0x4d22e7","je 0x37"],["0x4d22e9","call CFrontend::FUN_004a9700 (FUNCTION)"]],"recomp":[["0x401491","je 0x76"],["0x401493","call <OFFSET9> \t(Frontend.cpp:88)"]]},{"both":[["0x4d22ee","test eax, eax","0x401498"],["0x4d22f0","je 0x17","0x40149a"],["0x4d22f2","movsx eax, bl \t(Frontend.cpp:89)","0x40149c"],["0x4d22f5","push eax","0x40149f"]]},{"orig":[["0x4d22f6","call CGameInfo::GetGameRegionDirectory (FUNCTION)"]],"recomp":[["0x4014a0","call <OFFSET21>"]]},{"both":[["0x4d22fb","push eax","0x4014a5"]]},{"orig":[["0x4d22fc","call CInstallInfo::GetCountrySpecificDir (FUNCTION)"]],"recomp":[["0x4014a6","call <OFFSET22>"]]},{"both":[["0x4d2301","push eax","0x4014ab"],["0x4d2302","push CFrontend::m_feRes1024CCountrySpecific[0] (DATA)","0x4014ac"],["0x4d2307","jmp 0x4c \t(Frontend.cpp:90)","0x4014b1"],["0x4d2309","movsx ecx, bl \t(Frontend.cpp:91)","0x4014b3"],["0x4d230c","push ecx","0x4014b6"]]},{"orig":[["0x4d230d","call CGameInfo::GetGameRegionDirectory (FUNCTION)"]],"recomp":[["0x4014b7","call <OFFSET21>"]]},{"both":[["0x4d2312","push eax","0x4014bc"]]},{"orig":[["0x4d2313","call CInstallInfo::GetCountrySpecificDir (FUNCTION)"]],"recomp":[["0x4014bd","call <OFFSET22>"]]},{"both":[["0x4d2318","push eax","0x4014c2"],["0x4d2319","push CFrontend::m_feRes1024CountrySpecific[0] (DATA)","0x4014c3"],["0x4d231e","jmp 0x35 \t(Frontend.cpp:95)","0x4014c8"]]},{"orig":[["0x4d2320","call CFrontend::FUN_004a9700 (FUNCTION)"]],"recomp":[["0x4014ca","call <OFFSET9> \t(Frontend.cpp:97)"]]},{"both":[["0x4d2325","test eax, eax","0x4014cf"],["0x4d2327","je 0x17","0x4014d1"],["0x4d2329","movsx edx, bl \t(Frontend.cpp:98)","0x4014d3"],["0x4d232c","push edx","0x4014d6"]]},{"orig":[["0x4d232d","call CGameInfo::GetGameRegionDirectory (FUNCTION)"]],"recomp":[["0x4014d7","call <OFFSET21>"]]},{"both":[["0x4d2332","push eax","0x4014dc"]]},{"orig":[["0x4d2333","call CInstallInfo::GetCountrySpecificDir (FUNCTION)"]],"recomp":[["0x4014dd","call <OFFSET22>"]]},{"both":[["0x4d2338","push eax","0x4014e2"],["0x4d2339","push CFrontend::m_feRes640CCountrySpecific[0] (DATA)","0x4014e3"],["0x4d233e","jmp 0x15 \t(Frontend.cpp:99)","0x4014e8"],["0x4d2340","movsx eax, bl \t(Frontend.cpp:100)","0x4014ea"],["0x4d2343","push eax","0x4014ed"]]},{"orig":[["0x4d2344","call CGameInfo::GetGameRegionDirectory (FUNCTION)"]],"recomp":[["0x4014ee","call <OFFSET21>"]]},{"both":[["0x4d2349","push eax","0x4014f3"]]},{"orig":[["0x4d234a","call CInstallInfo::GetCountrySpecificDir (FUNCTION)"]],"recomp":[["0x4014f4","call <OFFSET22>"]]},{"both":[["0x4d234f","push eax","0x4014f9"],["0x4d2350","push CFrontend::m_feRes640CountrySpecific[0] (DATA)","0x4014fa"],["0x4d2355","push CFrontend::m_stringDest[0] (DATA)","0x4014ff"]]},{"orig":[["0x4d235a","call <OFFSET15>"]],"recomp":[["0x401504","call esi"]]},{"both":[["0x4d235f","add esp, 0x14","0x401506"],["0x4d2362","push CFrontend::m_stringDest[0] (DATA) \t(Frontend.cpp:103)","0x401509"],["0x4d2367","push CFrontend::m_unk0x00818260 (DATA)","0x40150e"]]},{"orig":[["0x4d236c","call CGenericFileLoader::FUN_004a9d70 (FUNCTION)"]],"recomp":[["0x401513","call <OFFSET16>"],["0x401518","pop edi"]]},{"both":[["0x4d2371","pop esi","0x401519"],["0x4d2372","pop ebx","0x40151a"],["0x4d2373","ret  \t(Frontend.cpp:104)","0x40151b"]]},{"orig":[["0x4d2374","nop "],["0x4d2375","nop "],["0x4d2376","nop "],["0x4d2377","nop "],["0x4d2378","nop "],["0x4d2379","nop "],["0x4d237a","nop "],["0x4d237b","nop "]],"recomp":[]}]]]},{"address":"0x4de170","name":"FormatCentisecondsAsMinSecMSec","matching":0.9538461538461539,"recomp":"0x401f80","diff":[["@@ -0x4de1a0,15 +0x401fb0,14 @@",[{"both":[["0x4de1a0","push edx","0x401fb0"],["0x4de1a1","imul ecx","0x401fb1"],["0x4de1a3","sar edx, 7","0x401fb3"],["0x4de1a6","mov ecx, edx","0x401fb6"],["0x4de1a8","shr ecx, 0x1f","0x401fb8"],["0x4de1ab","add edx, ecx","0x401fbb"],["0x4de1ad","push edx","0x401fbd"],["0x4de1ae","mov edx, dword ptr [esp + 0x18]","0x401fbe"],["0x4de1b2","push \"%02d:%02d.%02d\" (STRING)","0x401fc2"],["0x4de1b7","push edx","0x401fc7"]]},{"orig":[["0x4de1b8","call <OFFSET2>"]],"recomp":[["0x401fc8","call dword ptr [->MSVCRT.dll::sprintf (IMPORT)]"]]},{"both":[["0x4de1bd","add esp, 0x14","0x401fce"],["0x4de1c0","pop esi","0x401fd1"],["0x4de1c1","ret 8 \t(TimingUtils.cpp:12)","0x401fd2"]]},{"orig":[["0x4de1c4","nop "]],"recomp":[]}]]]}]};
      var data = report["data"];
    </script>
    <script>// reccmp.js
/* global data */

// Unwrap array of functions into a dictionary with address as the key.
const dataDict = Object.fromEntries(data.map((row) => [row.address, row]));

function getDataByAddr(addr) {
  return dataDict[addr];
}

//
// Pure functions
//

function formatAsm(entries, _addrOption) {
  const output = [];

  const createTh = (text) => {
    const th = document.createElement('th');
    th.innerText = text;
    return th;
  };

  const createTd = (text, className = '') => {
    const td = document.createElement('td');
    td.innerText = text;
    td.className = className;
    return td;
  };

  entries.forEach((obj) => {
    // These won't all be present. You get "both" for an equal node
    // and orig/recomp for a diff.
    const { both = [], orig = [], recomp = [] } = obj;

    output.push(
      ...both.map(([addr, line, recompAddr]) => {
        const tr = document.createElement('tr');
        tr.appendChild(createTh(addr));
        tr.appendChild(createTh(recompAddr));
        tr.appendChild(createTd(line));
        return tr;
      }),
    );

    output.push(
      ...orig.map(([addr, line]) => {
        const tr = document.createElement('tr');
        tr.appendChild(createTh(addr));
        tr.appendChild(createTh(''));
        tr.appendChild(createTd(`-${line}`, 'diffneg'));
        return tr;
      }),
    );

    output.push(
      ...recomp.map(([addr, line]) => {
        const tr = document.createElement('tr');
        tr.appendChild(createTh(''));
        tr.appendChild(createTh(addr));
        tr.appendChild(createTd(`+${line}`, 'diffpos'));
        return tr;
      }),
    );
  });

  return output;
}

// Special internal values to ensure this sort order for matching column:
// 1. Stub
// 2. Any match percentage [0.0, 1.0)
// 3. Effective match
// 4. Actual 100% match
function matchingColAdjustment(row) {
  if ('stub' in row) {
    return -1;
  }

  if ('effective' in row) {
    return 1.0;
  }

  if (row.matching === 1.0) {
    return 1000;
  }

  return row.matching;
}

function getCppClass(str) {
  const idx = str.indexOf('::');
  if (idx !== -1) {
    return str.slice(0, idx);
  }

  return str;
}

// Clamp string length to specified length and pad with ellipsis
function stringTruncate(str, maxlen = 20) {
  str = getCppClass(str);
  if (str.length > maxlen) {
    return `${str.slice(0, maxlen)}...`;
  }

  return str;
}

function getMatchPercentText(row) {
  if ('stub' in row) {
    return 'stub';
  }

  if ('effective' in row) {
    return '100.00%*';
  }

  return `${(row.matching * 100).toFixed(2)}%`;
}

function countDiffs(row) {
  const { diff = '' } = row;
  if (diff === '') {
    return '';
  }

  const diffs = diff.flatMap(([_slug, subgroups]) => subgroups);
  const diffLength = diffs.filter((d) => !('both' in d)).length;
  const diffWord = diffLength === 1 ? 'diff' : 'diffs';
  return diffLength === 0 ? '' : `${diffLength} ${diffWord}`;
}

// Helper for this set/remove attribute block
function setBooleanAttribute(element, attribute, value) {
  if (value) {
    element.setAttribute(attribute, '');
  } else {
    element.removeAttribute(attribute);
  }
}

function copyToClipboard(value) {
  navigator.clipboard.writeText(value);
}

const PAGE_SIZE = 200;

//
// Global state
//

class ListingState {
  constructor() {
    this._query = '';
    this._sortCol = 'address';
    this._filterType = 1;
    this._sortDesc = false;
    this._hidePerfect = false;
    this._hideStub = false;
    this._showRecomp = false;
    this._expanded = {};
    this._page = 0;

    this._listeners = [];

    this._results = [];
    this.updateResults();
  }

  addListener(fn) {
    this._listeners.push(fn);
  }

  callListeners() {
    for (const fn of this._listeners) {
      fn();
    }
  }

  isExpanded(addr) {
    return addr in this._expanded;
  }

  toggleExpanded(addr) {
    this.setExpanded(addr, !this.isExpanded(addr));
  }

  setExpanded(addr, value) {
    if (value) {
      this._expanded[addr] = true;
    } else {
      delete this._expanded[addr];
    }
  }

  updateResults() {
    const filterFn = this.rowFilterFn.bind(this);
    const sortFn = this.rowSortFn.bind(this);

    this._results = data.filter(filterFn).sort(sortFn);

    // Set _page directly to avoid double call to listeners.
    this._page = this.pageClamp(this.page);
    this.callListeners();
  }

  pageSlice() {
    return this._results.slice(this.page * PAGE_SIZE, (this.page + 1) * PAGE_SIZE);
  }

  resultsCount() {
    return this._results.length;
  }

  pageCount() {
    return Math.ceil(this._results.length / PAGE_SIZE);
  }

  maxPage() {
    return Math.max(0, this.pageCount() - 1);
  }

  // A list showing the range of each page based on the sort column and direction.
  pageHeadings() {
    if (this._results.length === 0) {
      return [];
    }

    const headings = [];

    for (let i = 0; i < this.pageCount(); i++) {
      const startIdx = i * PAGE_SIZE;
      const endIdx = Math.min(this._results.length, (i + 1) * PAGE_SIZE) - 1;

      let start = this._results[startIdx][this.sortCol];
      let end = this._results[endIdx][this.sortCol];

      if (this.sortCol === 'matching') {
        start = getMatchPercentText(this._results[startIdx]);
        end = getMatchPercentText(this._results[endIdx]);
      }

      headings.push([i, stringTruncate(start), stringTruncate(end)]);
    }

    return headings;
  }

  rowFilterFn(row) {
    // Destructuring sets defaults for optional values from this object.
    const { effective = false, stub = false, diff = '', name, address, matching } = row;

    if (this.hidePerfect && (effective || matching >= 1)) {
      return false;
    }

    if (this.hideStub && stub) {
      return false;
    }

    if (this.query === '') {
      return true;
    }

    // Name/addr search
    if (this.filterType === 1) {
      return address.includes(this.query) || name.toLowerCase().includes(this.query);
    }

    // no diff for review.
    if (diff === '') {
      return false;
    }

    // special matcher for combined diff
    const anyLineMatch = ([_addr, line]) => line.toLowerCase().trim().includes(this.query);

    // Flatten all diff groups for the search
    const diffs = diff.flatMap(([_slug, subgroups]) => subgroups);
    for (const subgroup of diffs) {
      const { both = [], orig = [], recomp = [] } = subgroup;

      // If search includes context
      if (this.filterType === 2 && both.some(anyLineMatch)) {
        return true;
      }

      if (orig.some(anyLineMatch) || recomp.some(anyLineMatch)) {
        return true;
      }
    }

    return false;
  }

  rowSortFn(rowA, rowB) {
    const valA = this.sortCol === 'matching' ? matchingColAdjustment(rowA) : rowA[this.sortCol];

    const valB = this.sortCol === 'matching' ? matchingColAdjustment(rowB) : rowB[this.sortCol];

    if (valA > valB) {
      return this.sortDesc ? -1 : 1;
    } else if (valA < valB) {
      return this.sortDesc ? 1 : -1;
    }

    return 0;
  }

  pageClamp(page) {
    return Math.max(0, Math.min(page, this.maxPage()));
  }

  get page() {
    return this._page;
  }

  set page(page) {
    this._page = this.pageClamp(page);
    this.callListeners();
  }

  get filterType() {
    return parseInt(this._filterType);
  }

  set filterType(value) {
    value = parseInt(value);
    if (value >= 1 && value <= 3) {
      this._filterType = value;
    }
    this.updateResults();
  }

  get query() {
    return this._query;
  }

  set query(value) {
    // Normalize search string
    this._query = value.toLowerCase().trim();
    this.updateResults();
  }

  get showRecomp() {
    return this._showRecomp;
  }

  set showRecomp(value) {
    // Don't sort by the recomp column we are about to hide
    if (!value && this.sortCol === 'recomp') {
      this._sortCol = 'address';
    }

    this._showRecomp = value;
    this.callListeners();
  }

  get sortCol() {
    return this._sortCol;
  }

  set sortCol(column) {
    if (column === this._sortCol) {
      this._sortDesc = !this._sortDesc;
    } else {
      this._sortCol = column;
    }

    this.updateResults();
  }

  get sortDesc() {
    return this._sortDesc;
  }

  set sortDesc(value) {
    this._sortDesc = value;
    this.updateResults();
  }

  get hidePerfect() {
    return this._hidePerfect;
  }

  set hidePerfect(value) {
    this._hidePerfect = value;
    this.updateResults();
  }

  get hideStub() {
    return this._hideStub;
  }

  set hideStub(value) {
    this._hideStub = value;
    this.updateResults();
  }
}

const appState = new ListingState();

//
// Custom elements
//

// Sets sort indicator arrow based on element attributes.
class SortIndicator extends window.HTMLElement {
  static observedAttributes = ['data-sort'];

  attributeChangedCallback(_name, _oldValue, newValue) {
    if (newValue === null) {
      // Reserve space for blank indicator so column width stays the same
      this.innerHTML = '&nbsp;';
    } else {
      this.innerHTML = newValue === 'asc' ? '&#9650;' : '&#9660;';
    }
  }
}

class CanCopy extends window.HTMLElement {
  connectedCallback() {
    this.addEventListener('mouseout', () => {
      this.copied = false;
    });

    this.addEventListener('click', (evt) => {
      copyToClipboard(evt.target.textContent);
      this.copied = true;
    });
  }

  get copied() {
    return this.getAttribute('copied');
  }

  set copied(value) {
    if (value) {
      setTimeout(() => {
        this.copied = false;
      }, 2000);
    }
    setBooleanAttribute(this, 'copied', value);
  }
}

class DiffDisplayOptions extends window.HTMLElement {
  static observedAttributes = ['data-option'];

  connectedCallback() {
    if (this.shadowRoot !== null) {
      return;
    }

    const shadow = this.attachShadow({ mode: 'open' });
    shadow.innerHTML = `
      <style>
        fieldset {
          align-items: center;
          display: flex;
          margin-bottom: 20px;
        }

        label {
          margin-right: 10px;
          user-select: none;
        }

        label, input {
          cursor: pointer;
        }
      </style>
      <fieldset>
        <legend>Address display:</legend>
        <input type="radio" id="showNone" name="addrDisplay" value=0>
        <label for="showNone">None</label>
        <input type="radio" id="showOrig" name="addrDisplay" value=1>
        <label for="showOrig">Original</label>
        <input type="radio" id="showBoth" name="addrDisplay" value=2>
        <label for="showBoth">Both</label>
      </fieldset>`;

    shadow.querySelectorAll('input[type=radio]').forEach((radio) => {
      const checked = this.option === radio.getAttribute('value');
      setBooleanAttribute(radio, 'checked', checked);

      radio.addEventListener('change', (evt) => {
        this.option = evt.target.value;
      });
    });
  }

  set option(value) {
    this.setAttribute('data-option', parseInt(value));
  }

  get option() {
    return this.getAttribute('data-option') ?? 1;
  }

  attributeChangedCallback(name, _oldValue, _newValue) {
    if (name !== 'data-option') {
      return;
    }

    this.dispatchEvent(new Event('change'));
  }
}

class DiffDisplay extends window.HTMLElement {
  static observedAttributes = ['data-option'];

  connectedCallback() {
    if (this.querySelector('diff-display-options') !== null) {
      return;
    }

    const optControl = new DiffDisplayOptions();
    optControl.option = this.option;
    optControl.addEventListener('change', (evt) => {
      this.option = evt.target.option;
    });
    this.appendChild(optControl);

    const div = document.createElement('div');
    const obj = getDataByAddr(this.address);

    const createHeaderLine = (text, className) => {
      const div = document.createElement('div');
      div.textContent = text;
      div.className = className;
      return div;
    };

    const groups = obj.diff;
    groups.forEach(([slug, subgroups]) => {
      const secondTable = document.createElement('table');
      secondTable.classList.add('diffTable');

      const hdr = document.createElement('div');
      hdr.appendChild(createHeaderLine('---', 'diffneg'));
      hdr.appendChild(createHeaderLine('+++', 'diffpos'));
      hdr.appendChild(createHeaderLine(slug, 'diffslug'));
      div.appendChild(hdr);

      const tbody = document.createElement('tbody');
      secondTable.appendChild(tbody);

      const diffs = formatAsm(subgroups, this.option);
      for (const el of diffs) {
        tbody.appendChild(el);
      }

      div.appendChild(secondTable);
    });

    this.appendChild(div);
  }

  get address() {
    return this.getAttribute('data-address');
  }

  set address(value) {
    this.setAttribute('data-address', value);
  }

  get option() {
    return this.getAttribute('data-option') ?? 1;
  }

  set option(value) {
    this.setAttribute('data-option', value);
  }
}

class ListingOptions extends window.HTMLElement {
  constructor() {
    super();

    // Register to receive updates
    appState.addListener(() => this.onUpdate());

    const input = this.querySelector('input[type=search]');
    input.oninput = (evt) => {
      appState.query = evt.target.value;
    };

    const hidePerf = this.querySelector('input#cbHidePerfect');
    hidePerf.onchange = (evt) => {
      appState.hidePerfect = evt.target.checked;
    };
    hidePerf.checked = appState.hidePerfect;

    const hideStub = this.querySelector('input#cbHideStub');
    hideStub.onchange = (evt) => {
      appState.hideStub = evt.target.checked;
    };
    hideStub.checked = appState.hideStub;

    const showRecomp = this.querySelector('input#cbShowRecomp');
    showRecomp.onchange = (evt) => {
      appState.showRecomp = evt.target.checked;
    };
    showRecomp.checked = appState.showRecomp;

    this.querySelector('button#pagePrev').addEventListener('click', () => {
      appState.page = appState.page - 1;
    });

    this.querySelector('button#pageNext').addEventListener('click', () => {
      appState.page = appState.page + 1;
    });

    this.querySelector('select#pageSelect').addEventListener('change', (evt) => {
      appState.page = evt.target.value;
    });

    this.querySelectorAll('input[name=filterType]').forEach((radio) => {
      const checked = appState.filterType === parseInt(radio.getAttribute('value'));
      radio.checked = checked;

      radio.onchange = () => {
        appState.filterType = radio.getAttribute('value');
      };
    });

    this.onUpdate();
  }

  onUpdate() {
    // Update input placeholder based on search type
    this.querySelector('input[type=search]').placeholder =
      appState.filterType === 1 ? 'Search for offset or function name...' : 'Search for instruction...';

    // Update page number and max page
    this.querySelector('fieldset#pageDisplay > legend').textContent =
      `Page ${appState.page + 1} of ${Math.max(1, appState.pageCount())}`;

    // Disable prev/next buttons on first/last page
    setBooleanAttribute(this.querySelector('button#pagePrev'), 'disabled', appState.page === 0);
    setBooleanAttribute(this.querySelector('button#pageNext'), 'disabled', appState.page === appState.maxPage());

    // Update page select dropdown
    const pageSelect = this.querySelector('select#pageSelect');
    setBooleanAttribute(pageSelect, 'disabled', appState.resultsCount() === 0);
    pageSelect.innerHTML = '';

    if (appState.resultsCount() === 0) {
      const opt = document.createElement('option');
      opt.textContent = '- no results -';
      pageSelect.appendChild(opt);
    } else {
      for (const row of appState.pageHeadings()) {
        const opt = document.createElement('option');
        opt.value = row[0];
        if (appState.page === row[0]) {
          opt.setAttribute('selected', '');
        }

        const [start, end] = [row[1], row[2]];

        opt.textContent = `${appState.sortCol}: ${start} to ${end}`;
        pageSelect.appendChild(opt);
      }
    }

    // Update row count
    this.querySelector('#rowcount').textContent = `${appState.resultsCount()}`;
  }
}

// Main application.
class ListingTable extends window.HTMLElement {
  constructor() {
    super();

    // Register to receive updates
    appState.addListener(() => this.somethingChanged());
  }

  diffRow(address, showRecomp) {
    const obj = getDataByAddr(address);

    let contents;

    if ('stub' in obj) {
      contents = document.createElement('div');
      contents.setAttribute('class', 'no-diff');
      contents.textContent = 'Stub. No diff.';
    } else if (obj.diff.length === 0) {
      contents = document.createElement('div');
      contents.setAttribute('class', 'no-diff');
      contents.textContent = 'Identical function - no diff';
    } else {
      contents = document.createElement('diff-display');
      contents.setAttribute('data-option', '1');
      contents.setAttribute('data-address', address);
    }

    const td = document.createElement('td');
    td.setAttribute('colspan', showRecomp ? 5 : 4);
    td.append(contents);

    const tr = document.createElement('tr');
    tr.setAttribute('data-diff', address);
    tr.append(td);
    return tr;
  }

  funcRow(obj, showRecomp) {
    const createColumn = (dataCol, canCopy, textContent) => {
      const td = document.createElement('td');
      td.setAttribute('data-col', dataCol);
      if (canCopy) {
        const copy = document.createElement('can-copy');
        copy.textContent = textContent;
        td.append(copy);
      } else {
        td.append(textContent);
      }

      return td;
    };

    const cols = {
      address: createColumn('address', true, obj.address),
      recomp: createColumn('recomp', true, obj.recomp),
      name: createColumn('name', false, obj.name),
      diffs: createColumn('diffs', false, countDiffs(obj)),
      matching: createColumn('matching', false, getMatchPercentText(obj)),
    };

    if (!showRecomp) {
      delete cols.recomp;
    }

    const tr = document.createElement('tr');
    tr.setAttribute('data-address', obj.address);
    tr.append(...Object.values(cols));
    return tr;
  }

  headerRow(showRecomp, sortCol, sortDesc) {
    const cols = {
      address: 'Address',
      recomp: 'Recomp',
      name: 'Name',
      diffs: '',
      matching: 'Matching',
    };

    if (!showRecomp) {
      delete cols.recomp;
    }

    const headers = Object.entries(cols).map(([key, name]) => {
      if (key === 'diffs') {
        const th = document.createElement('th');
        th.setAttribute('data-col', 'diffs');
        th.setAttribute('data-no-sort', true);
        return th;
      }

      const sort_indicator = document.createElement('sort-indicator');
      if (key === sortCol) {
        sort_indicator.setAttribute('data-sort', sortDesc ? 'desc' : 'asc');
      }

      const th = document.createElement('th');
      th.setAttribute('data-col', key);
      const div = document.createElement('div');
      const span = document.createElement('span');
      span.textContent = name;
      div.append(span, sort_indicator);
      th.append(div);
      return th;
    });

    const tr = document.createElement('tr');
    tr.append(...headers);
    return tr;
  }

  setDiffRow(address, shouldExpand) {
    const tbody = this.querySelector('tbody');
    const funcrow = tbody.querySelector(`tr[data-address="${address}"]`);
    if (funcrow === null) {
      return;
    }

    const existing = tbody.querySelector(`tr[data-diff="${address}"]`);
    if (existing !== null) {
      if (!shouldExpand) {
        tbody.removeChild(existing);
      }

      return;
    }

    // Insert the diff row after the parent func row.
    funcrow.insertAdjacentElement('afterend', this.diffRow(address, appState.showRecomp));
  }

  connectedCallback() {
    this.addEventListener('name-click', (evt) => {
      appState.toggleExpanded(evt.detail);
      this.setDiffRow(evt.detail, appState.isExpanded(evt.detail));
    });

    this.innerHTML = '<table id="listing"><thead></thead><tbody></tbody></table>';

    this.somethingChanged();
  }

  somethingChanged() {
    const header_row = this.headerRow(appState.showRecomp, appState.sortCol, appState.sortDesc);

    const rows = [];

    // Create rows for this page.
    for (const obj of appState.pageSlice()) {
      rows.push(this.funcRow(obj, appState.showRecomp));
      if (appState.isExpanded(obj.address)) {
        rows.push(this.diffRow(obj.address, appState.showRecomp));
      }
    }

    this.querySelector('thead').replaceChildren(header_row);
    this.querySelector('tbody').replaceChildren(...rows);

    this.querySelectorAll('th:not([data-no-sort])').forEach((th) => {
      const col = th.getAttribute('data-col');
      if (col) {
        const span = th.querySelector('span');
        if (span) {
          span.addEventListener('click', () => {
            appState.sortCol = col;
          });
        }
      }
    });

    this.querySelectorAll('tr[data-address]').forEach((row) => {
      // Clicking the name column toggles the diff detail row.
      // This is added or removed without replacing the entire <tbody>.
      row.querySelector('td[data-col="name"]').addEventListener('click', () => {
        this.dispatchEvent(new CustomEvent('name-click', { detail: row.getAttribute('data-address') }));
      });
    });
  }
}

window.onload = () => {
  window.customElements.define('listing-table', ListingTable);
  window.customElements.define('listing-options', ListingOptions);
  window.customElements.define('diff-display', DiffDisplay);
  window.customElements.define('diff-display-options', DiffDisplayOptions);
  window.customElements.define('sort-indicator', SortIndicator);
  window.customElements.define('can-copy', CanCopy);
};
</script>
    </script>
  </head>
  <body>
    <div class="main">
      <h1>Decompilation Status</h1>
      <listing-options>
        <input id="search" type="search" placeholder="Search for offset or function name...">
        <div class="filters">
          <fieldset>
            <legend>Options:</legend>
            <input type="checkbox" id="cbHidePerfect" />
            <label for="cbHidePerfect">Hide 100% match</label>
            <input type="checkbox" id="cbHideStub" />
            <label for="cbHideStub">Hide stubs</label>
            <input type="checkbox" id="cbShowRecomp" />
            <label for="cbShowRecomp">Show recomp address</label>
          </fieldset>
          <fieldset>
            <legend>Search filters on:</legend>
            <input type="radio" name="filterType" id="filterName" value=1 checked />
            <label for="filterName">Name/address</label>
            <input type="radio" name="filterType" id="filterAsm" value=2 />
            <label for="filterAsm">Asm output</label>
            <input type="radio" name="filterType" id="filterDiff" value=3 />
            <label for="filterDiff">Asm diffs only</label>
          </fieldset>
        </div>
        <div class="filters">
          <p class="rowcount">Results: <span id="rowcount"></span></p>
          <fieldset id="pageDisplay">
            <legend>Page</legend>
            <button id="pagePrev">prev</button>
            <select id="pageSelect">
            </select>
            <button id="pageNext">next</button>
          </fieldset>
        </div>
      </listing-options>
      <listing-table>
      </listing-table>
    </div>
  </body>
</html>
